# Операции над множествами

### .Concat, .Union

Объединяют две последовательности в одну. Первый объединяет как есть, второй - без дубликатов:

```C#
string[] seq1 = { "One", "Two" };
string[] seq2 = { "Three", "Two" };

var concat = seq1.Concat(seq2);  // One, Two, Three, Two
var union = seq1.Union(seq2);  // One, Two, Three
```

### .Intersect, .Except

Intersect возвращают элементы, которые есть в обоих последовательностях. Except возвращает элементы, которые отсутствуют во второй последовательности:

```c#
var intersect = seq1.Intersect(seq2);  // Two
var except = seq1.Except(seq2);  // One
```

### .First, .Last, .ElementAt

Возвращает первый, последний и элемент в указанной позиции соответственно. First и Last имеют версии с параметром, задающим условие отбора:

```c#
string[] names = { "Tom", "Bill", "Adam" };
var first = names.First();  // Tom
var last = names.Last();  // Adam
var at1 = names.ElementAt(1);  // Bill
```

Если последовательность пустая или нет элемента с указанным индексом, выбрасывают исключение. На этот случай есть модификации FirstOrDefault, LastOrDefault, ElementAtOrDefault, которые возвращают значение по умолчанию вместо исключения. Для ссылочных типов значение по умолчанию null, для bool - false, для числовых 0.

### .Single

Если последовательность содержит только один элемент, то возвращает его. Если ни одного или больше одного - выбрасывает исключение:

```c#
string[] names = { "Tom", "Bill", "Adam" };
var name = names.Single();  // Исключение

string[] names = { "Tom" };
var name = names.Single();  // Tom
```

SingleOrDefault в случае с пустой последовательностью возвращает значение по умолчанию. Но если в последовательности больше одного элемента, все равно генерирует исключение.

### .DefaultIfEmpty

Если последовательность пустая, то возвращает последовательность, содержащую один элемент со значением по умолчанию. Если не пустая, то возвращает исходную последовательность в неизмененном виде.

> _требует доработки: "Применяется при написании плоских внутренних соединений. За деталями обращайтесь в раздел "Выполнение внешних соединений с помощью SelectMany" и "Плоские внешние соединения" главы 9_