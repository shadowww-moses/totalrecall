# Connected и Disconnected сценарии

В зависимости от архитектуры приложения может быть два сценария использования контекста:

## Connected

Сценарий, который подразумевает, что извлечение объекта, работа с ним и последующее сохранение производится в пределах одного контекста:

```c#
var context = new YoucubeContext();
var user = context.Users.FirstOrDefault(u => u.Username == "ShadowwwMoses");
user.Username = "ShadowMoses";
context.SaveChanges();
```

Такой сценарий возможен, например, в настольном приложении, когда контекст создается и используется на протяжении длительного времени.

## Disconnected

Сценарий, когда объект извлекается в одном контексте, а сохраняется - в другом. Такой сценарий характерен, например, для WebAPI приложений. Когда запрос приходит на контроллер, создается экземпляр контекста, данные извлекаются и отправляются клиенту, например, для редактирования, а экземпляр контекста уничтожается в конце запроса. Затем от пользователя приходят модифицированные данные, снова создается очередной экземпляр контекста, который ничего не знает о состоянии этих данных, о том, какими они были при извлечении. Для него они являются новыми.

Имитация данной ситуации:

```c#
var context = new YoucubeContext();
var user = context.Users.AsNoTracking()
    .FirstOrDefault(u => u.Username == "ShadowwwMoses");
user.Username = "ShadowMoses";
using (var newContext = new YoucubeContext())
{
    newContext.Update(user);
    newContext.SaveChanges();
}
```