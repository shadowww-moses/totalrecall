# Shadow Properties

SP - это техника, позволяющая хранить в базе данных дополнительную информацию о сущности. В классе самой сущности поля для этой информации создавать не нужно, но при этом можно использовать эти поля в запросах. Это позволяет разгрузить сущности от некоторых вещей, которые могут не иметь отношения к бизнес-логике, но при этом хранят информацию, полезную в каких-то случаях.

<img src="img\image-20200508110153477.png" alt="image-20200508110153477" style="zoom:80%;" />

## Создание SP

SP объявляются в методе `OnModelCreating` контекста:

<img src="img\image-20200508110753748.png" alt="image-20200508110753748" style="zoom:80%;" />

Если нужно создать одинаковые SP для множества сущностей, можно сделать это в цикле:

<img src="img\image-20200508125233278.png" alt="image-20200508125233278" style="zoom:80%;" />

## Запись и чтение SP

Запись:

<img src="img\image-20200508134824830.png" alt="image-20200508134824830" style="zoom:80%;" />

А с помощью проекции можно выбрать значение SP:

<img src="img\image-20200508142204248.png" alt="image-20200508142204248" style="zoom:80%;" />

## Использование SP в запросах

<img src="img\image-20200508141436211.png" alt="image-20200508141436211" style="zoom:80%;" />



## SP и перегрузка SaveChanges()

Интересный пример, позволяющий при сохранении объектов заполнять их SP времени создания и последнего доступа:

<img src="img\image-20200508141036962.png" alt="image-20200508141036962" style="zoom:80%;" />
