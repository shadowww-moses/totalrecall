# Какие SQL-запросы генерирует EF?

Существует несколько способов посмотреть, какие SQL-запросы генерирует EF при работе с БД. Это можно сделать, например, подключив в программу **логгер** или воспользовавшись **профайлером**

## Логгер

Этот метод предназначен для использования логгера в консольном приложении. Для, например, проекта ASP.NET Core логгер подключается иначе.

* Устанавливаем в сборку с EF пакет `Microsoft.Extensions.Logging.Console` 

* Подключаем в файле с контекстом неймспейс `Microsfot.Extensions.Logging`

* Добавляем в класс контекста поле типа `ILoggerFactory`:

  <img src="img\image-20200503125220862.png" alt="image-20200503125220862" style="zoom:80%;" />

* В методе контекста `OnConfiguring` подключаем этот логгер:

  <img src="img\image-20200503125423168.png" alt="image-20200503125423168" style="zoom:80%;" />

Теперь при выполнении программы в консоль будут выводится SQL-запросы, которые формирует EF к базе.

## Профайлер

Профайлер становится доступным после установки SQL Server'а (или, возможно, Management Studio). Вызвать его можно либо через меню пуск, найдя по слову "profiler", либо из Management Studio, меню `Tools > SQL Server Profiler`

* Выбираем сервер:

<img src="img\image-20200504143824548.png" alt="image-20200504143824548" style="zoom:80%;" />

* Выбираем стандартный шаблон:

  <img src="img\image-20200504150858642.png" alt="image-20200504150858642" style="zoom:80%;" />

* Теперь все операции, проходящие на указанном сервере, будут отображаться в профайлере:

  <img src="img\image-20200504151138032.png" alt="image-20200504151138032" style="zoom:80%;" />
